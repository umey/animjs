<!DOCTYPE HTML>
<html>
<head>
    <title>morph shape test</title>
    <script src="http://code.createjs.com/easeljs-0.4.2.min.js"></script>
    <script src="http://code.createjs.com/tweenjs-0.2.0.min.js"></script>

    <script src="../src/QBezier.js"></script>
    <script src="../src/Path.js"></script>
    <script src="../src/MorphPath.js"></script>
    <script src="../src/MorphShape.js"></script>
    <script src="../src/MorphShapeBuilder.js"></script>


</head>
<body onload = "init();">

<canvas id="canvas" width="400" height="320" style="background-color:#ffffff"></canvas>
<P>
    click to morph
</P>
<script>
    function init(){
        var canvas = document.getElementById("canvas");
        var stage = new Stage(canvas);

        // create MorphPath like "Graphics.beginFill()..."
        var mp0 = new MorphPath().f("#FFCC00").moveTo(10,10).lineTo(30,10).lineTo(30,30).lineTo(10,30).lineTo(10,10);

        //　create a circle path
        var mp1 = new MorphPath();
        var data1 = [240,160, 240,193,216,216,193,240,160,240, 126,240,103,216,80,193, 80,160, 80,127,103,103,127, 80,160, 80,193, 80,216,103,240,127,240,160];
        mp1.f("#990000").read(data1);

        //　ninja
        var mp2 = new MorphPath();
        mp2.f("#000000").read(getNinjaData());

        //　create MorphShape(Shape with morphing data) by MorphShapeBuilder
        var b = new MorphShapeBuilder();
        var motionShape0 = b.build(mp0,mp1,50);
        var motionShape1 = b.build(mp1,mp2,150,Ease.bounceOut); //Easing OK.
        var motionShape2 = b.build(mp2,mp0,100);

        stage.addChild(motionShape0);
        // stop/play animation by gotoAndStop, gotoAndPlay
        var mShapes = [motionShape0,motionShape1,motionShape2];
        var index = 2;
        canvas.onmousedown = function(){
            mShapes[index].gotoAndStop(0);
            stage.removeChild(mShapes[index]);
            index=(mShapes.length+index+1)%mShapes.length;
            mShapes[index].gotoAndPlay(0);
            stage.addChild(mShapes[index]);
        };

        // show the path
        var mp0path = new Shape();
        var mp1path = new Shape();
        var mp2path = new Shape();
        mp0.drawPath(mp0path);
        mp1.drawPath(mp1path);
        mp2.drawPath(mp2path);

        stage.addChild(mp0path,mp1path,mp2path);

        Ticker.setFPS(60);
        Ticker.addListener(stage);

        var rect0 = motionShape0.startRect;
        var rect1 = motionShape1.endRect;
        console.log(rect0.top,rect0.left,rect0.width,rect0.height);
        console.log(rect1.top,rect1.left,rect1.width,rect1.height);
    }

    function getNinjaData(){
        return [
            169.95,39.4,170.45,41.95,170.6,46.55,170.8,50.8,170.45,52.7,168.4,61.9,167.2,64.1,166.55,65.3,
            167.2,67.35,167.55,68.35,168.05,69.2,168.05,69.2,170.6,67.7,173.2,66.5,174.2,68.05,175.05,69.2,
            175.9,70.95,176.75,72.3,178.15,72.3,178.8,72.3,183.25,71.1,186.5,70.25,186.8,71.1,187.15,72.65,
            193.8,75.7,194.15,76.05,198.25,79.3,202,82.2,202.35,82.85,207.1,89.5,207.8,91.75,208.65,93.95,
            207.65,107.25,206.8,121.25,205.05,122.25,203.7,123.3,200.65,124.3,200.65,124.3,197.75,125.35,192.3,
            121.05,188,125,185.95,125,183.4,124.8,182.05,124.8,179.65,124.8,179.65,126.2,179.65,128.25,180.15,
            132.5,180.85,137.6,181.7,138.65,183.75,141.2,188.2,148.2,193.65,156.9,194.15,159.45,194.85,162.35,
            194.85,163.35,194.65,164.55,193.8,166.75,192.95,169.15,192.3,177.85,191.6,186.55,192.3,188.25,192.95,
            190.65,193.8,204.3,194,205.65,194.85,210.1,195.5,214.35,195,217.25,194.65,219.65,193.8,225.6,192.8,230.55,
            191.1,231.6,187.5,233.6,186.8,235.15,185.95,236.7,184.8,275.75,184.6,277.8,185.1,282.55,185.65,287.85,
            186.3,289.9,187.35,292.3,190.4,294.65,194.15,297.55,198.1,298.45,202.15,299.3,203.9,301.85,205.6,304.4,
            203.9,305.1,202,305.75,197.75,305.95,192.45,306.1,189.9,305.1,188,304.4,181,304.2,174.7,304.05,173.5,
            303.05,171.3,301.35,170.95,300.3,170.3,298.6,171.45,295.7,173,292.45,171.45,284.25,166.85,259.35,166,250,
            165.7,244.2,166,239.95,166,239.95,166.55,237.05,161.4,229.35,157.85,235.85,155.6,235.5,154.6,235.35,155.8,
            242.85,157.3,251.7,156.3,254.6,155.1,258.35,155.45,272.15,155.8,285.1,156.65,288.7,157.3,290.75,159.2,296.2,
            160.2,301,157.5,302.35,155.1,303.35,145.4,303.05,135.15,302.7,133.6,303.05,130.55,304.05,128.15,304.05,125.25,
            303.9,126.3,302,127.15,300.45,130.05,298.75,134.3,296.4,134.8,296.05,138.2,294,139.9,292.8,143.15,290.6,143.35,
            288.7,143.5,287.85,138.75,264.3,133.8,240.45,134.45,233.6,135.15,227.15,131.75,227.8,126.95,228.85,125.75,226.65,
            123.4,222.35,121.5,216.25,119.65,209.9,119.3,205.8,118.95,202.6,121.15,189.45,123.55,176,123.55,175.8,123.55,
            175.15,122.2,170.7,120.8,166.25,120.8,163.7,120.8,159.8,121.15,158.6,121.5,157.05,123.05,155.5,125.45,153.15,
            129.2,148.7,133.45,143.4,133.6,141.85,133.6,141.85,134.15,130.1,132.75,129.25,131.25,128.4,128.15,126.7,127.5,
            126.85,111.8,132.85,109.05,131.65,107,130.8,102.9,126.7,98.8,122.6,98.8,121.4,97.3,105.9,98.15,104.7,98.3,
            104.35,103.25,100.75,107.85,97.35,107.85,96.5,107.2,94.95,106.85,94.1,106.15,92.75,107.85,91.75,110.6,90.2,
            121.15,80.8,121.35,80.3,121.85,79.65,122.7,78.25,123.9,78.1,125.75,77.75,134.45,77.75,135.65,77.75,124.25,
            61.05,122,57.95,122.2,57.45,123.4,54.55,126.3,55.05,126.3,55.05,140.25,76.2,142.65,72.3,141.95,71.8,141.45,
            70.95,140.45,69.4,141.1,68.7,142.3,67.5,144.2,66.3,143.35,66.3,141.8,62.25,140.25,58.3,139.9,56.25,140.25,
            43.3,140.25,40.55,140.25,38.55,141.95,35.3,143.7,31.85,145.4,30.5,147.25,29,153.25,29,159.35,29,162.6,30.5,
            168.75,33.25,169.95,39.4
        ];
    }
</script>
</body>
</html>